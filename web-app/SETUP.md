# 案件登録ウェブアプリケーション - セットアップガイド

## Google Apps Scriptのデプロイ手順

### 1. スクリプトのデプロイ

1. Googleスプレッドシートを開く
2. 「拡張機能」→「Apps Script」を選択
3. `コード.js`の内容をコピーして貼り付け
4. 「デプロイ」→「新しいデプロイ」を選択
5. 種類の選択で「ウェブアプリ」を選択
6. 設定：
   - 説明: 「案件登録API」（任意）
   - 実行ユーザー: 「自分」
   - アクセスできるユーザー: 「全員」
7. 「デプロイ」をクリック
8. 承認を求められた場合は承認を実行
9. デプロイされたURLをコピー（例: `https://script.google.com/macros/s/XXXXXXXXXX/exec`）

### 2. API URLの設定

コピーしたURLをフロントエンドの環境変数`NEXT_PUBLIC_GAS_API_URL`に設定してください。

## Google OAuth設定手順

### 1. Google Cloud Consoleでプロジェクト作成

1. [Google Cloud Console](https://console.cloud.google.com/)にアクセス
2. 新しいプロジェクトを作成（または既存のプロジェクトを選択）

### 2. OAuth同意画面の設定

1. 「APIとサービス」→「OAuth同意画面」を選択
2. ユーザータイプを選択（外部または内部）
3. アプリ情報を入力：
   - アプリ名: 「案件登録システム」
   - ユーザーサポートメール: あなたのメールアドレス
   - 開発者の連絡先情報: あなたのメールアドレス
4. スコープはデフォルトのままでOK
5. テストユーザーを追加（必要に応じて）
6. 「保存して次へ」をクリック

### 3. OAuth 2.0クライアントIDの作成

1. 「APIとサービス」→「認証情報」を選択
2. 「認証情報を作成」→「OAuth 2.0クライアントID」を選択
3. アプリケーションの種類: 「ウェブアプリケーション」
4. 名前: 「案件登録システム」
5. 承認済みのリダイレクトURIを追加：
   - 開発環境: `http://localhost:3000`
   - 本番環境: `https://your-domain.com`（デプロイ後に設定）
6. 「作成」をクリック
7. クライアントIDをコピー

### 4. クライアントIDの設定

コピーしたクライアントIDをフロントエンドの環境変数`NEXT_PUBLIC_GOOGLE_CLIENT_ID`に設定してください。

## トラブルシューティング

### API接続エラー

- Google Apps ScriptのURLが正しいか確認
- デプロイ設定で「アクセスできるユーザー」が「全員」になっているか確認
- スクリプトの実行権限が正しく設定されているか確認

### 認証エラー

- Google Cloud ConsoleでOAuth同意画面が正しく設定されているか確認
- 承認済みのリダイレクトURIに正しいURLが設定されているか確認
- クライアントIDが正しく設定されているか確認

### データが登録されない

- Google Apps Scriptのログシートを確認
- スプレッドシートに適切なシートが存在するか確認
- 必須項目がすべて入力されているか確認

